<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Attendance — Professional Light UI</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
/* === SAME CSS – NO CHANGE === */
:root{
  --bg:#f6f8fb; --card:#fff; --muted:#6b7280; --text:#0f1724;
  --accent:#0f6ef6; --accent-600:#0b5cd6;
  --success:#16a34a; --danger:#ef4444; --soft:#eef4ff;
  --radius:12px; --container:1100px; --input-border:#e6edf8;
  --btn-padding:11px 16px;
}
*{box-sizing:border-box}
html,body{margin:0;font-family:Inter;background:var(--bg)}
.wrap{max-width:var(--container);margin:28px auto;padding:22px}
button{cursor:pointer;font-weight:700;border-radius:10px;padding:var(--btn-padding);border:0}
.btn-primary{background:linear-gradient(90deg,var(--accent),var(--accent-600));color:#fff}
.btn-outline{border:1px solid var(--input-border);background:#fff}
.status{font-size:14px}
</style>
</head>

<body>
<div class="wrap">

  <h2>Employee Attendance</h2>

  <select id="empSelect"></select>
  <br><br>

  <button id="submitBtn" type="button" class="btn-primary">
    Submit
  </button>

  <button id="clearBtn" type="button" class="btn-outline">
    Clear
  </button>

  <div id="status" class="status"></div>

</div>

<script>
/* ===== CONFIG ===== */
const GAS_WEBAPP_URL =
'https://script.google.com/macros/s/AKfycbyjCaQtRhPn3noyKXYx_RiAgl--EFfmzrIdzWV71LAyKMF069JqQVRo9B8kiHXa4zsy/exec';

const $ = id => document.getElementById(id);

/* ===== STATUS ===== */
function setStatus(msg, ok){
  $('status').textContent = msg || '';
  $('status').style.color = ok === true ? 'green' :
                            ok === false ? 'red' : '#555';
}

/* ===== SUBMIT (ONLY ONE FLOW) ===== */
async function submitAttendance(){

  setStatus('Submitting...', null);
  $('submitBtn').disabled = true;

  const payload = {
    empId: $('empSelect').value || 'TEST',
    mode: 'IN',
    note: 'demo',
    source: 'WEBAPP'
  };

  try {
    const res = await fetch(GAS_WEBAPP_URL,{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });

    const data = await res.json();

    if(data && data.status === 'ok'){
      setStatus('Attendance submitted successfully ✔', true);
    } else {
      setStatus('Server error', false);
    }

  } catch(e){
    setStatus('Network / CORS error', false);
    console.error(e);
  } finally {
    $('submitBtn').disabled = false;
  }
}

/* ===== EVENTS ===== */
document.addEventListener('DOMContentLoaded', () => {
  $('submitBtn').addEventListener('click', submitAttendance);
  $('clearBtn').addEventListener('click', ()=> setStatus('',null));
});
</script>

</body>
</html>
